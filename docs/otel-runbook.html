<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>otel-demo â€” OpenTelemetry Runbook</title>
  <style>
    /* â”€â”€ Light theme tokens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    :root {
      --bg:        #f8fafc;
      --surface:   #ffffff;
      --surface2:  #f1f5f9;
      --surface3:  #e8edf5;
      --border:    #dde3ec;
      --border2:   #c8d2e0;
      --accent:    #4338ca;      /* indigo */
      --accent-lt: #ede9fe;
      --accent2:   #0f766e;      /* teal */
      --accent2-lt:#ccfbf1;
      --warn:      #b45309;      /* amber */
      --warn-lt:   #fef3c7;
      --danger:    #b91c1c;      /* red */
      --danger-lt: #fee2e2;
      --success:   #15803d;      /* green */
      --success-lt:#dcfce7;
      --text:      #0f172a;
      --text2:     #334155;
      --muted:     #64748b;
      --code-bg:   #f0f4f8;
      --code-text: #1e293b;
      --link:      #3730a3;
      --nav-bg:    #1e293b;
      --nav-text:  #cbd5e1;
      --nav-hover: #334155;
      --nav-active:#4338ca;
      --nav-section:#94a3b8;
      --docker-tab:#2563eb;
      --podman-tab:#7c3aed;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    html { scroll-behavior: smooth; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                   "Helvetica Neue", Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.75;
      font-size: 15px;
    }

    /* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .layout { display: flex; min-height: 100vh; }

    nav {
      width: 268px;
      min-width: 268px;
      background: var(--nav-bg);
      padding: 1.5rem 0;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      flex-shrink: 0;
    }

    main {
      flex: 1;
      padding: 2.5rem 3.5rem 4rem;
      max-width: 980px;
      min-width: 0;
    }

    /* â”€â”€ Nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .nav-logo {
      display: flex; align-items: center; gap: .5rem;
      padding: 0 1.2rem 1.2rem;
      border-bottom: 1px solid #2d3f55;
      margin-bottom: .8rem;
    }
    .nav-logo .logo-text {
      font-size: .95rem; font-weight: 700;
      color: #f1f5f9; letter-spacing: -.01em;
    }
    .nav-logo .logo-text span { color: #818cf8; }
    .nav-logo .logo-badge {
      font-size: .65rem; font-weight: 600; text-transform: uppercase;
      letter-spacing: .06em; background: #312e81; color: #a5b4fc;
      padding: .15em .5em; border-radius: 4px;
    }

    nav ul { list-style: none; }
    nav ul li { }
    nav ul li a {
      display: block;
      padding: .35rem 1.2rem;
      color: var(--nav-text);
      text-decoration: none;
      font-size: .82rem;
      transition: background .12s, color .12s;
      border-left: 3px solid transparent;
    }
    nav ul li a:hover {
      color: #f1f5f9;
      background: var(--nav-hover);
      border-left-color: #818cf8;
    }
    nav ul li a.active {
      color: #c7d2fe;
      background: #1e3050;
      border-left-color: var(--nav-active);
    }
    .nav-section {
      font-size: .67rem; font-weight: 700; text-transform: uppercase;
      letter-spacing: .1em; color: var(--nav-section);
      padding: 1rem 1.2rem .35rem;
    }
    nav ul li.sub a { padding-left: 2rem; font-size: .79rem; }

    /* â”€â”€ Top hero â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .hero {
      background: linear-gradient(135deg, #4338ca 0%, #0f766e 100%);
      color: #fff;
      border-radius: 12px;
      padding: 2rem 2.5rem;
      margin-bottom: 2.5rem;
    }
    .hero h1 { font-size: 1.8rem; font-weight: 800; color: #fff; margin-bottom: .4rem; }
    .hero p  { color: rgba(255,255,255,.85); font-size: .95rem; margin: 0; }
    .hero-tags { display: flex; gap: .5rem; flex-wrap: wrap; margin-top: 1rem; }
    .hero-tag {
      background: rgba(255,255,255,.18); color: #fff;
      font-size: .72rem; font-weight: 600; padding: .2em .7em;
      border-radius: 20px; letter-spacing: .03em;
    }

    /* â”€â”€ Typography â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    h2 {
      font-size: 1.35rem; font-weight: 700; color: var(--accent);
      margin: 2.5rem 0 1rem;
      padding-bottom: .45rem;
      border-bottom: 2px solid var(--border);
      display: flex; align-items: center; gap: .5rem;
    }
    h2 .h-icon { font-size: 1rem; opacity: .7; }
    h3 {
      font-size: 1rem; font-weight: 700; color: var(--text);
      margin: 1.6rem 0 .6rem;
    }
    h4 {
      font-size: .88rem; font-weight: 700;
      color: var(--accent2); margin: 1.2rem 0 .4rem;
      text-transform: uppercase; letter-spacing: .05em;
    }
    p  { margin-bottom: .85rem; color: var(--text2); }
    a  { color: var(--link); text-decoration: none; }
    a:hover { text-decoration: underline; }
    ul, ol { margin: .4rem 0 .9rem 1.5rem; color: var(--text2); }
    li { margin-bottom: .3rem; }
    strong { color: var(--text); font-weight: 600; }
    .muted   { color: var(--muted); font-size: .85rem; }
    .subtitle { color: var(--muted); font-size: .95rem; margin-bottom: 2rem; }

    /* â”€â”€ Code â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    pre {
      background: var(--code-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.1rem 1.3rem;
      overflow-x: auto;
      margin: .7rem 0 1.2rem;
      font-size: .8rem;
      line-height: 1.7;
      position: relative;
    }
    code { font-family: "JetBrains Mono","Fira Code","Cascadia Code",Menlo,monospace; }
    pre code { color: var(--code-text); }
    :not(pre) > code {
      background: var(--surface2);
      color: var(--accent);
      padding: .1em .4em;
      border-radius: 4px;
      font-size: .8em;
      border: 1px solid var(--border);
    }
    pre .comment { color: #64748b; }
    pre .cmd     { color: #1e40af; }
    pre .str     { color: #15803d; }
    pre .key     { color: #7c3aed; }

    /* â”€â”€ Tabbed code blocks (Docker / Podman) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tab-group { margin: .7rem 0 1.2rem; border-radius: 8px; overflow: hidden; border: 1px solid var(--border); }
    .tab-header { display: flex; background: var(--surface2); border-bottom: 1px solid var(--border); }
    .tab-btn {
      padding: .45rem 1.1rem;
      font-size: .78rem; font-weight: 700;
      border: none; background: none; cursor: pointer;
      color: var(--muted); letter-spacing: .02em;
      transition: color .15s, background .15s;
      border-bottom: 2px solid transparent; margin-bottom: -1px;
    }
    .tab-btn:hover { color: var(--text); background: var(--surface3); }
    .tab-btn.active-docker { color: var(--docker-tab); border-bottom-color: var(--docker-tab); background: var(--surface); }
    .tab-btn.active-podman { color: var(--podman-tab); border-bottom-color: var(--podman-tab); background: var(--surface); }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .tab-content pre { border-radius: 0; border: none; margin: 0; }
    .tab-label {
      display: inline-block; font-size: .67rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: .06em;
      padding: .1em .5em; border-radius: 3px; margin-right: .4rem;
      vertical-align: middle;
    }
    .tab-label.docker { background: #dbeafe; color: var(--docker-tab); }
    .tab-label.podman { background: #ede9fe; color: var(--podman-tab); }

    /* â”€â”€ Callouts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .callout {
      border-left: 4px solid;
      border-radius: 0 8px 8px 0;
      padding: .9rem 1.1rem;
      margin: 1rem 0 1.3rem;
      font-size: .875rem;
    }
    .callout.info    { border-color: var(--accent);  background: var(--accent-lt);  }
    .callout.warn    { border-color: var(--warn);    background: var(--warn-lt);    }
    .callout.success { border-color: var(--success); background: var(--success-lt); }
    .callout.danger  { border-color: var(--danger);  background: var(--danger-lt);  }
    .callout .label  {
      font-weight: 800; text-transform: uppercase; font-size: .68rem;
      letter-spacing: .08em; margin-bottom: .3rem;
    }
    .callout.info    .label { color: var(--accent); }
    .callout.warn    .label { color: var(--warn); }
    .callout.success .label { color: var(--success); }
    .callout.danger  .label { color: var(--danger); }
    .callout p:last-child { margin-bottom: 0; }
    .callout ul { color: inherit; }

    /* â”€â”€ Install cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .install-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
      gap: 1rem; margin: 1rem 0 1.5rem;
    }
    .install-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 1rem 1.2rem;
      transition: box-shadow .15s, border-color .15s;
    }
    .install-card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
      border-color: var(--border2);
    }
    .install-card .ic-header {
      display: flex; align-items: center; gap: .55rem; margin-bottom: .5rem;
    }
    .install-card .ic-icon {
      width: 32px; height: 32px; border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      font-size: 1rem;
    }
    .install-card .ic-name { font-weight: 700; font-size: .9rem; color: var(--text); }
    .install-card .ic-version {
      font-size: .72rem; color: var(--muted); margin-left: auto;
      background: var(--surface2); padding: .1em .5em; border-radius: 4px;
    }
    .install-card .ic-desc { color: var(--text2); font-size: .82rem; margin-bottom: .6rem; }
    .install-card .ic-cmd {
      background: var(--code-bg);
      border: 1px solid var(--border);
      border-radius: 5px;
      font-family: "JetBrains Mono","Fira Code",monospace;
      font-size: .75rem;
      padding: .4rem .7rem;
      color: var(--code-text);
      white-space: pre;
      overflow-x: auto;
      display: block;
    }
    .ic-required { border-top: 3px solid var(--accent); }
    .ic-optional { border-top: 3px solid var(--accent2); }

    /* â”€â”€ Checklist â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .checklist { list-style: none; margin: .5rem 0 1rem; }
    .checklist li {
      display: flex; align-items: flex-start; gap: .6rem;
      padding: .35rem 0; border-bottom: 1px solid var(--border);
      font-size: .875rem; color: var(--text2);
    }
    .checklist li:last-child { border-bottom: none; }
    .checklist .chk {
      width: 1.2rem; height: 1.2rem; border-radius: 50%;
      background: var(--success-lt); color: var(--success);
      display: flex; align-items: center; justify-content: center;
      font-size: .7rem; font-weight: 700; flex-shrink: 0; margin-top: .1rem;
    }
    .checklist .chk.opt {
      background: var(--accent2-lt); color: var(--accent2);
    }

    /* â”€â”€ Step boxes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .steps { counter-reset: step; }
    .step {
      display: flex; gap: 1rem;
      margin: 1rem 0;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 1rem 1.2rem;
      transition: box-shadow .15s;
    }
    .step:hover { box-shadow: 0 2px 8px rgba(0,0,0,.07); }
    .step-num {
      counter-increment: step;
      min-width: 2rem; height: 2rem;
      background: var(--accent);
      color: #fff;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 800; font-size: .82rem; flex-shrink: 0; margin-top: .05rem;
    }
    .step-num::before { content: counter(step); }
    .step-body { flex: 1; }
    .step-body p:last-child { margin-bottom: 0; }

    /* â”€â”€ Tables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .table-wrap { overflow-x: auto; margin: .7rem 0 1.4rem; border-radius: 8px; border: 1px solid var(--border); }
    table { width: 100%; border-collapse: collapse; font-size: .84rem; }
    th {
      background: var(--surface2);
      color: var(--text);
      text-align: left;
      padding: .6rem .9rem;
      font-size: .74rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: .05em;
      border-bottom: 2px solid var(--border);
    }
    td { padding: .6rem .9rem; border-bottom: 1px solid var(--border); vertical-align: top; color: var(--text2); }
    tr:last-child td { border-bottom: none; }
    tr:hover td { background: var(--surface2); }

    /* â”€â”€ Badges â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .badge {
      display: inline-block; padding: .15em .6em; border-radius: 5px;
      font-size: .72rem; font-weight: 700; font-family: monospace;
      letter-spacing: .02em;
    }
    .badge.get    { background: #dcfce7; color: #15803d; }
    .badge.post   { background: #dbeafe; color: #1d4ed8; }
    .badge.patch  { background: #fef3c7; color: #b45309; }
    .badge.put    { background: #ccfbf1; color: #0f766e; }
    .badge.delete { background: #fee2e2; color: #b91c1c; }
    .badge.s201   { background: #dcfce7; color: #15803d; }
    .badge.s200   { background: #dcfce7; color: #15803d; }
    .badge.s204   { background: #dcfce7; color: #15803d; }
    .badge.s404   { background: #fef3c7; color: #b45309; }
    .badge.s400   { background: #fee2e2; color: #b91c1c; }
    .badge.s409   { background: #fee2e2; color: #b91c1c; }

    /* â”€â”€ Signal tags â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tag { display: inline-block; font-size: .72rem; padding: .1em .6em; border-radius: 20px; margin: .1em; }
    .tag.trace  { background: var(--accent-lt);  color: var(--accent); }
    .tag.metric { background: var(--accent2-lt); color: var(--accent2); }
    .tag.log    { background: var(--warn-lt);    color: var(--warn); }

    /* â”€â”€ Port grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .port-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
      gap: .75rem; margin: 1rem 0 1.5rem;
    }
    .port-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px; padding: .8rem 1rem;
      transition: box-shadow .15s;
    }
    .port-card:hover { box-shadow: 0 2px 8px rgba(0,0,0,.07); }
    .port-card .svc-name { font-weight: 700; font-size: .88rem; color: var(--text); }
    .port-card .svc-port { font-family: monospace; color: var(--accent); font-size: .82rem; margin: .1rem 0; }
    .port-card .svc-desc { color: var(--muted); font-size: .76rem; }

    /* â”€â”€ Diagram â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .diagram {
      background: #1e293b;
      border-radius: 10px;
      padding: 1.3rem 1.5rem;
      font-family: "JetBrains Mono","Fira Code",monospace;
      font-size: .76rem;
      color: #94a3b8;
      white-space: pre;
      overflow-x: auto;
      margin: 1rem 0 1.5rem;
      line-height: 1.55;
    }
    .diagram .d-hl  { color: #818cf8; }
    .diagram .d-hl2 { color: #34d399; }
    .diagram .d-box { color: #e2e8f0; }

    /* â”€â”€ Section separator â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    hr { border: none; border-top: 2px solid var(--border); margin: 2.5rem 0; }
    .anchor { scroll-margin-top: 1.5rem; }

    /* â”€â”€ OS choice banner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .runtime-banner {
      display: flex; gap: .75rem; align-items: center;
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 8px; padding: .8rem 1.1rem;
      font-size: .84rem; margin: .7rem 0 1.2rem;
    }
    .runtime-banner .rb-label { font-weight: 700; color: var(--muted); margin-right: .25rem; }
    .rb-pill {
      padding: .2em .75em; border-radius: 20px; font-size: .75rem; font-weight: 700; cursor: default;
    }
    .rb-pill.docker { background: #dbeafe; color: var(--docker-tab); }
    .rb-pill.podman { background: #ede9fe; color: var(--podman-tab); }
    .rb-note { color: var(--muted); font-size: .8rem; }

    /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 820px) {
      nav { display: none; }
      main { padding: 1.5rem; }
      .hero { padding: 1.5rem; }
    }
  </style>

  <script>
    // Tab switching for Docker / Podman code blocks
    function switchTab(groupId, runtime) {
      const group = document.getElementById(groupId);
      group.querySelectorAll('.tab-btn').forEach(b => {
        b.classList.remove('active-docker','active-podman');
      });
      group.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      const btn = group.querySelector('.tab-btn[data-rt="'+runtime+'"]');
      btn.classList.add('active-' + runtime);
      group.querySelector('.tab-content[data-rt="'+runtime+'"]').classList.add('active');
    }

    // Highlight active nav link on scroll
    document.addEventListener('DOMContentLoaded', () => {
      const anchors = document.querySelectorAll('.anchor');
      const navLinks = document.querySelectorAll('nav a');
      const observer = new IntersectionObserver(entries => {
        entries.forEach(e => {
          if (e.isIntersecting) {
            navLinks.forEach(l => l.classList.remove('active'));
            const id = e.target.id;
            const link = document.querySelector('nav a[href="#'+id+'"]');
            if (link) link.classList.add('active');
          }
        });
      }, { rootMargin: '-10% 0px -80% 0px' });
      anchors.forEach(a => observer.observe(a));
    });
  </script>
</head>
<body>
<div class="layout">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIDEBAR NAV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav>
  <div class="nav-logo">
    <div>
      <div class="logo-text">otel<span>-demo</span></div>
    </div>
    <span class="logo-badge">Runbook</span>
  </div>

  <div class="nav-section">Overview</div>
  <ul>
    <li><a href="#architecture">Architecture</a></li>
    <li><a href="#signal-flow">Signal Flow</a></li>
    <li><a href="#services">Services &amp; Ports</a></li>
  </ul>

  <div class="nav-section">Installation</div>
  <ul>
    <li><a href="#install-overview">What You Need</a></li>
    <li><a href="#install-java">Java 21</a></li>
    <li><a href="#install-maven">Maven</a></li>
    <li><a href="#install-docker">Docker</a></li>
    <li><a href="#install-podman">Podman</a></li>
    <li><a href="#install-agent">OTel Agent</a></li>
    <li><a href="#install-verify">Verify Setup</a></li>
  </ul>

  <div class="nav-section">Running the Stack</div>
  <ul>
    <li><a href="#start-infra">1 â€” Start Infra</a></li>
    <li><a href="#start-app">2 â€” Start App</a></li>
    <li><a href="#verify-signals">3 â€” Verify Signals</a></li>
  </ul>

  <div class="nav-section">API Reference</div>
  <ul>
    <li><a href="#api-endpoints">All Endpoints</a></li>
    <li><a href="#api-create">Create</a></li>
    <li><a href="#api-get">Get by ID</a></li>
    <li><a href="#api-list">List (Paginated)</a></li>
    <li><a href="#api-patch">Partial Update</a></li>
    <li><a href="#api-put">Full Replace</a></li>
    <li><a href="#api-search">Search</a></li>
    <li><a href="#api-delete">Delete</a></li>
    <li><a href="#api-errors">Error Responses</a></li>
  </ul>

  <div class="nav-section">Load &amp; E2E Testing</div>
  <ul>
    <li><a href="#load-test">Load Test Script</a></li>
    <li><a href="#e2e-test">E2E Lifecycle Test</a></li>
    <li><a href="#manual-curl">Manual curl Examples</a></li>
  </ul>

  <div class="nav-section">Grafana</div>
  <ul>
    <li><a href="#grafana-dashboards">Dashboards</a></li>
    <li><a href="#grafana-explore-traces">Explore â€” Traces</a></li>
    <li><a href="#grafana-explore-logs">Explore â€” Logs</a></li>
    <li><a href="#grafana-explore-metrics">Explore â€” Metrics</a></li>
    <li><a href="#trace-log-correlation">Trace â†’ Log Correlation</a></li>
  </ul>

  <div class="nav-section">Troubleshooting</div>
  <ul>
    <li><a href="#ts-no-traces">No Traces</a></li>
    <li><a href="#ts-no-metrics">No Metrics</a></li>
    <li><a href="#ts-no-logs">No Logs</a></li>
    <li><a href="#ts-dashboards-empty">Empty Dashboards</a></li>
    <li><a href="#ts-tempo">Tempo Issues</a></li>
  </ul>

  <div class="nav-section">Reference</div>
  <ul>
    <li><a href="#otel-config">OTel Config</a></li>
    <li><a href="#metric-names">Metric Names</a></li>
    <li><a href="#key-files">Key Files</a></li>
  </ul>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main>

  <!-- Hero -->
  <div class="hero">
    <h1>otel-demo OpenTelemetry Runbook</h1>
    <p>
      Complete guide for installing, running, testing, and observing the
      <strong style="color:#fff">otel-demo</strong> Spring Boot application â€”
      with full distributed tracing, metrics, and structured logs.
    </p>
    <div class="hero-tags">
      <span class="hero-tag">Spring Boot 3.5</span>
      <span class="hero-tag">Java 21</span>
      <span class="hero-tag">OTel Java Agent 2.x</span>
      <span class="hero-tag">Grafana 11.4</span>
      <span class="hero-tag">Tempo 2.7</span>
      <span class="hero-tag">Prometheus</span>
      <span class="hero-tag">Loki</span>
      <span class="hero-tag">Docker / Podman</span>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="architecture" class="anchor"><span class="h-icon">ğŸ—</span> Architecture</h2>

  <p>
    <strong>otel-demo</strong> is a layered Spring Boot microservice for customer CRUD.
    Every HTTP request produces correlated traces, metrics, and structured logs â€” all
    exported through the OpenTelemetry Java agent to the full LGTM stack.
  </p>

  <div class="diagram">
<span class="d-box">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Spring Boot App  :8080 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                      â”‚
â”‚  HTTP â”€â”€â–º <span class="d-hl">CustomerController</span> â”€â”€â–º <span class="d-hl">CustomerService</span> â”€â”€â–º <span class="d-hl">Repository</span> â”€â”€â–º Postgres
â”‚                                  â”‚                                   â”‚
â”‚                         <span class="d-hl">CustomerEventPublisher</span> â”€â”€â–º Kafka               â”‚
â”‚                                                                      â”‚
â”‚  OTel Java Agent (auto-instrumentation)                              â”‚
â”‚    Traces  â†’ HTTP server Â· Spring Data Â· JDBC Â· Kafka producer      â”‚
â”‚    Metrics â†’ http.server.request.duration Â· jvm.* Â· db.* Â· kafka.*  â”‚
â”‚    Logs    â†’ Logback MDC (trace_id / span_id) â†’ OTLP exporter       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ <span class="d-hl2">OTLP/HTTP  :4318</span>
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚    <span class="d-hl">OTel Collector</span>           â”‚
               â”‚  recv: otlp gRPC + HTTP    â”‚
               â”‚  proc: batch + memlimiter  â”‚
               â”‚  export â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Prometheus scrape :8889
               â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
                  â”‚            â”‚          â”‚
        <span class="d-hl2">Tempo :3200</span>  <span class="d-hl2">Prometheus :9090</span>  <span class="d-hl2">Loki :3100</span>
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
               <span class="d-hl">Grafana  :3000  (Dashboards + Explore)</span></span>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="signal-flow" class="anchor"><span class="h-icon">ğŸ“¡</span> Signal Flow</h2>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Signal</th><th>Produced by</th><th>Transport</th><th>Collector export</th><th>Storage</th><th>View in</th></tr></thead>
    <tbody>
      <tr>
        <td><span class="tag trace">Traces</span></td>
        <td>OTel Java Agent bytecode</td>
        <td>OTLP/HTTP â†’ <code>:4318</code></td>
        <td>OTLP/gRPC â†’ Tempo <code>:4317</code></td>
        <td>Tempo <code>:3200</code></td>
        <td>Grafana â†’ Explore â†’ Tempo</td>
      </tr>
      <tr>
        <td><span class="tag metric">Metrics</span></td>
        <td>OTel Java Agent (OTLP push)</td>
        <td>OTLP/HTTP â†’ <code>:4318</code></td>
        <td>Prometheus exposition <code>:8889</code></td>
        <td>Prometheus <code>:9090</code></td>
        <td>Grafana Dashboards &amp; Explore</td>
      </tr>
      <tr>
        <td><span class="tag log">Logs</span></td>
        <td>Logback + OTel appender</td>
        <td>OTLP/HTTP â†’ <code>:4318</code></td>
        <td>OTLP/HTTP â†’ Loki <code>:3100</code></td>
        <td>Loki <code>:3100</code></td>
        <td>Grafana â†’ Explore â†’ Loki</td>
      </tr>
    </tbody>
  </table>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="services" class="anchor"><span class="h-icon">ğŸ”Œ</span> Services &amp; Ports</h2>

  <div class="port-grid">
    <div class="port-card">
      <div class="svc-name">Spring Boot App</div>
      <div class="svc-port">:8080</div>
      <div class="svc-desc">Customer REST API + Actuator</div>
    </div>
    <div class="port-card">
      <div class="svc-name">Grafana</div>
      <div class="svc-port">:3000</div>
      <div class="svc-desc">Dashboards &amp; Explore â€” no login required</div>
    </div>
    <div class="port-card">
      <div class="svc-name">Prometheus</div>
      <div class="svc-port">:9090</div>
      <div class="svc-desc">PromQL query UI</div>
    </div>
    <div class="port-card">
      <div class="svc-name">Tempo</div>
      <div class="svc-port">:3200</div>
      <div class="svc-desc">Distributed trace storage &amp; query</div>
    </div>
    <div class="port-card">
      <div class="svc-name">Loki</div>
      <div class="svc-port">:3100</div>
      <div class="svc-desc">Log aggregation &amp; LogQL query</div>
    </div>
    <div class="port-card">
      <div class="svc-name">OTel Collector</div>
      <div class="svc-port">:4317 / :4318 / :8889</div>
      <div class="svc-desc">gRPC recv / HTTP recv / Prometheus export</div>
    </div>
    <div class="port-card">
      <div class="svc-name">PostgreSQL</div>
      <div class="svc-port">:5432</div>
      <div class="svc-desc">demodb Â· demouser Â· demopass</div>
    </div>
    <div class="port-card">
      <div class="svc-name">Kafka</div>
      <div class="svc-port">:9092</div>
      <div class="svc-desc">customer-events topic (KRaft mode)</div>
    </div>
    <div class="port-card">
      <div class="svc-name">Collector zPages</div>
      <div class="svc-port">:55679</div>
      <div class="svc-desc"><code>/debug/tracez</code> live span inspector</div>
    </div>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       INSTALLATION
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="install-overview" class="anchor"><span class="h-icon">ğŸ“¦</span> Installation â€” What You Need</h2>

  <p>
    This guide covers macOS (Apple Silicon and Intel) and Linux. Windows users should use
    WSL 2 with Ubuntu and follow the Linux instructions.
  </p>

  <div class="runtime-banner">
    <span class="rb-label">Container runtime:</span>
    <span class="rb-pill docker">ğŸ‹ Docker Desktop</span>
    <span style="color:var(--muted)">or</span>
    <span class="rb-pill podman">ğŸ¦­ Podman Desktop</span>
    <span class="rb-note">â€” either works; both sets of commands are shown throughout.</span>
  </div>

  <ul class="checklist">
    <li>
      <span class="chk">âœ“</span>
      <div><strong>Java 21 (LTS)</strong> â€” required to build and run the app. Java 25 is on many machines but is not supported.</div>
    </li>
    <li>
      <span class="chk">âœ“</span>
      <div><strong>Maven 3.9+</strong> â€” build tool. Use system <code>mvn</code>; the bundled <code>./mvnw</code> wrapper is not reliable in this repo.</div>
    </li>
    <li>
      <span class="chk">âœ“</span>
      <div><strong>Docker Desktop <em>or</em> Podman Desktop</strong> â€” runs the full observability stack (7 containers).</div>
    </li>
    <li>
      <span class="chk">âœ“</span>
      <div><strong>OTel Java Agent JAR</strong> â€” placed at the project root as <code>opentelemetry-javaagent.jar</code>. Enables automatic instrumentation without code changes.</div>
    </li>
    <li>
      <span class="chk opt">â—‹</span>
      <div><strong>curl &amp; python3</strong> â€” used by the test scripts. Pre-installed on macOS and most Linux distros.</div>
    </li>
    <li>
      <span class="chk opt">â—‹</span>
      <div><strong>Git</strong> â€” to clone the repository. Pre-installed on macOS via Xcode Command Line Tools.</div>
    </li>
  </ul>

  <!-- â”€â”€ Java 21 â”€â”€ -->
  <h2 id="install-java" class="anchor"><span class="h-icon">â˜•</span> Install Java 21</h2>

  <p>
    Eclipse Temurin (formerly AdoptOpenJDK) is the recommended free, open-source Java 21 distribution.
    Multiple JDK versions can coexist â€” <code>/usr/libexec/java_home</code> (macOS) selects the right one.
  </p>

  <h3>macOS â€” Homebrew</h3>
  <pre><code># Install Eclipse Temurin 21 via Homebrew Cask
brew install --cask temurin@21

# Verify
/usr/libexec/java_home -v 21
# â†’ /Library/Java/JavaVirtualMachines/temurin-21.jdk/Contents/Home

$(/usr/libexec/java_home -v 21)/bin/java -version
# â†’ openjdk version "21.x.x" ...</code></pre>

  <h3>macOS â€” SDKMAN (alternative)</h3>
  <pre><code># Install SDKMAN first (if not already installed)
curl -s "https://get.sdkman.io" | bash
source "$HOME/.sdkman/bin/sdkman-init.sh"

# Install and use Temurin 21
sdk install java 21.0.5-tem
sdk use java 21.0.5-tem
java -version</code></pre>

  <h3>Ubuntu / Debian</h3>
  <pre><code>sudo apt-get update
sudo apt-get install -y wget apt-transport-https gpg

# Add Eclipse Temurin repository
wget -qO - https://packages.adoptium.net/artifactory/api/gpg/key/public \
  | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/adoptium.gpg

echo "deb https://packages.adoptium.net/artifactory/deb $(lsb_release -cs) main" \
  | sudo tee /etc/apt/sources.list.d/adoptium.list

sudo apt-get update
sudo apt-get install -y temurin-21-jdk
java -version</code></pre>

  <h3>Red Hat / Fedora / Amazon Linux</h3>
  <pre><code>sudo dnf install java-21-amazon-corretto-devel   # Amazon Linux / Fedora
# or
sudo yum install java-21-openjdk-devel            # RHEL / CentOS

java -version</code></pre>

  <div class="callout warn">
    <div class="label">Multiple Java versions</div>
    <p>
      If you have Java 25 (or any other version) installed alongside Java 21, always invoke
      Maven and the app using the explicit binary path â€” never just <code>java</code> or
      <code>JAVA_HOME=... java</code> (that sets the variable but not the PATH binary).
    </p>
    <pre style="margin-top:.5rem"><code># âœ… Correct â€” explicit binary
$(/usr/libexec/java_home -v 21)/bin/java -version

# âŒ Wrong â€” JAVA_HOME prefix doesn't change which java is on PATH
JAVA_HOME=$(/usr/libexec/java_home -v 21) java -version</code></pre>
  </div>

  <!-- â”€â”€ Maven â”€â”€ -->
  <h2 id="install-maven" class="anchor"><span class="h-icon">ğŸ”§</span> Install Maven 3.9+</h2>

  <h3>macOS â€” Homebrew</h3>
  <pre><code>brew install maven

# Verify
mvn -version
# â†’ Apache Maven 3.9.x ...</code></pre>

  <h3>Ubuntu / Debian</h3>
  <pre><code>sudo apt-get install -y maven
mvn -version</code></pre>

  <h3>Manual install (all platforms)</h3>
  <pre><code># Download and unpack Maven 3.9 binary
MVN_VER=3.9.9
curl -fsSL https://downloads.apache.org/maven/maven-3/${MVN_VER}/binaries/apache-maven-${MVN_VER}-bin.tar.gz \
  | sudo tar -xz -C /opt
sudo ln -s /opt/apache-maven-${MVN_VER}/bin/mvn /usr/local/bin/mvn

mvn -version</code></pre>

  <div class="callout info">
    <div class="label">Always build with Java 21</div>
    <p>Prefix every Maven command with the Java 21 home:</p>
    <pre style="margin-top:.5rem"><code>JAVA_HOME=$(/usr/libexec/java_home -v 21) mvn clean package -DskipTests</code></pre>
    <p>On Linux where you installed Temurin 21 as the only JDK, plain <code>mvn</code> works fine.</p>
  </div>

  <!-- â”€â”€ Docker â”€â”€ -->
  <h2 id="install-docker" class="anchor"><span class="h-icon">ğŸ‹</span> Install Docker Desktop</h2>

  <p>Docker Desktop bundles the Docker Engine, Docker Compose, and Docker CLI in one installer.</p>

  <h3>macOS</h3>
  <pre><code># Option A â€” Homebrew Cask (recommended)
brew install --cask docker

# Option B â€” direct download from Docker
# https://docs.docker.com/desktop/install/mac-install/
# Download Docker.dmg and drag to Applications</code></pre>

  <h3>Ubuntu / Debian</h3>
  <pre><code># Remove old versions
sudo apt-get remove docker docker-engine docker.io containerd runc

# Install prerequisites
sudo apt-get update
sudo apt-get install -y ca-certificates curl gnupg lsb-release

# Add Docker's GPG key and repository
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg \
  | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
  https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" \
  | sudo tee /etc/apt/sources.list.d/docker.list

# Install Docker Engine + Compose plugin
sudo apt-get update
sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin

# Add your user to the docker group (avoid sudo)
sudo usermod -aG docker $USER
newgrp docker</code></pre>

  <h3>Verify Docker</h3>
  <pre><code>docker version
docker compose version   # should be 2.x

# Test with hello-world
docker run --rm hello-world</code></pre>

  <!-- â”€â”€ Podman â”€â”€ -->
  <h2 id="install-podman" class="anchor"><span class="h-icon">ğŸ¦­</span> Install Podman Desktop</h2>

  <p>
    Podman is a daemonless, rootless container engine. On macOS it runs containers inside a
    lightweight Linux VM (<em>Podman Machine</em>). <strong>podman-compose</strong> is
    a separate pip/brew package that implements the Docker Compose spec.
  </p>

  <h3>macOS â€” Homebrew</h3>
  <pre><code># Install Podman engine and compose companion
brew install podman podman-compose

# Create and start the Podman machine (Linux VM)
podman machine init --cpus 4 --memory 4096 --disk-size 40
podman machine start

# Verify
podman version
podman-compose version</code></pre>

  <h3>macOS â€” Podman Desktop GUI</h3>
  <pre><code># Install Podman Desktop (GUI app â€” manages the machine for you)
brew install --cask podman-desktop

# Launch Podman Desktop from Applications, then click "Initialize and Start"
# Come back here once the machine is running and the socket is active</code></pre>

  <h3>Ubuntu / Debian</h3>
  <pre><code>sudo apt-get update
sudo apt-get install -y podman

# Install podman-compose via pip
pip3 install podman-compose

podman version
podman-compose version</code></pre>

  <h3>Configure Podman socket for Testcontainers</h3>
  <pre><code># Get the socket path (macOS)
podman machine inspect --format '{{.ConnectionInfo.PodmanSocket.Path}}'
# â†’ /var/folders/.../podman.sock  (or ~/.local/share/containers/... on Linux)

# Export for this shell session
export DOCKER_HOST="unix://$(podman machine inspect --format '{{.ConnectionInfo.PodmanSocket.Path}}')"
export TESTCONTAINERS_RYUK_DISABLED=true

# Verify â€” Docker CLI talks to Podman
docker info | grep "Server Version"</code></pre>

  <div class="callout info">
    <div class="label">Podman vs Docker for Testcontainers</div>
    <p>
      Testcontainers (used in integration tests) requires <code>DOCKER_HOST</code> to point to
      the Podman socket and <code>TESTCONTAINERS_RYUK_DISABLED=true</code> because Podman
      rootless mode does not support Ryuk (the Testcontainers resource reaper).
      The <code>infra/start.sh</code> and test scripts handle this automatically.
    </p>
  </div>

  <!-- â”€â”€ OTel Agent â”€â”€ -->
  <h2 id="install-agent" class="anchor"><span class="h-icon">ğŸ”­</span> Install the OTel Java Agent</h2>

  <p>
    The OpenTelemetry Java agent provides <strong>zero-code automatic instrumentation</strong>
    for Spring Boot, JDBC, Kafka, and dozens of other frameworks via Java bytecode manipulation.
    It must be present at the project root as <code>opentelemetry-javaagent.jar</code>.
  </p>

  <pre><code># Download the latest stable release to the project root
curl -L -o opentelemetry-javaagent.jar \
  https://github.com/open-telemetry/opentelemetry-java-instrumentation/releases/latest/download/opentelemetry-javaagent.jar

# Verify the file is a valid JAR
ls -lh opentelemetry-javaagent.jar
# â†’ -rw-r--r--  1 user  staff  ~55M  opentelemetry-javaagent.jar

java -jar opentelemetry-javaagent.jar 2>&1 | head -5
# â†’ OpenTelemetry Java agent X.Y.Z</code></pre>

  <div class="callout warn">
    <div class="label">Not committed to Git</div>
    The agent JAR is in <code>.gitignore</code>. Every developer must download it locally.
    A <code>55 MB+</code> binary should not be in source control.
  </div>

  <!-- â”€â”€ Verify â”€â”€ -->
  <h2 id="install-verify" class="anchor"><span class="h-icon">âœ…</span> Verify Your Setup</h2>

  <p>Run these checks before proceeding. Every item should pass.</p>

  <pre><code># 1. Java 21
$(/usr/libexec/java_home -v 21)/bin/java -version 2>&1 | head -1
# â†’ openjdk version "21.x.x" ...

# 2. Maven
JAVA_HOME=$(/usr/libexec/java_home -v 21) mvn -version | head -1
# â†’ Apache Maven 3.9.x ...

# 3. Container runtime (Docker)
docker info --format "Docker Engine {{.ServerVersion}}" 2>/dev/null
# â†’ Docker Engine 27.x

# 3. Container runtime (Podman â€” if using Podman instead)
podman version --format "Podman {{.Version}}" 2>/dev/null
# â†’ Podman 5.x

# 4. compose
docker compose version   # Docker
# or
podman-compose version   # Podman

# 5. OTel agent present
ls -lh opentelemetry-javaagent.jar
# â†’ file exists, ~55 MB

# 6. Build the project (first time â€” downloads dependencies)
JAVA_HOME=$(/usr/libexec/java_home -v 21) mvn clean package -DskipTests -q
ls target/otel-*-SNAPSHOT.jar
# â†’ target/otel-0.0.1-SNAPSHOT.jar</code></pre>

  <div class="callout success">
    <div class="label">All green?</div>
    If all six checks pass you are ready to start the stack. Continue to the next section.
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="start-infra" class="anchor"><span class="h-icon">ğŸš€</span> 1 â€” Start the Observability Infrastructure</h2>

  <h3>Option A â€” Automated script (recommended)</h3>
  <pre><code>./infra/start.sh</code></pre>
  <p>
    Auto-detects Docker or Podman, starts all 7 containers, waits for each service to
    become healthy, and prints a URL summary. Use <code>./infra/stop.sh</code> to bring
    it back down (add <code>--destroy</code> to also wipe volumes).
  </p>

  <h3>Option B â€” Manual compose</h3>

  <div class="tab-group" id="tg-start-infra">
    <div class="tab-header">
      <button class="tab-btn active-docker" data-rt="docker" onclick="switchTab('tg-start-infra','docker')">ğŸ‹ Docker</button>
      <button class="tab-btn" data-rt="podman" onclick="switchTab('tg-start-infra','podman')">ğŸ¦­ Podman</button>
    </div>
    <div class="tab-content active" data-rt="docker">
<pre><code># Start all containers in detached mode
docker compose -f infra/docker-compose.yml up -d

# Check container status
docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"

# Follow logs for a specific service
docker compose -f infra/docker-compose.yml logs -f grafana</code></pre>
    </div>
    <div class="tab-content" data-rt="podman">
<pre><code># Export Podman socket so compose can find the daemon
export DOCKER_HOST="unix://$(podman machine inspect \
  --format '{{.ConnectionInfo.PodmanSocket.Path}}')"
export TESTCONTAINERS_RYUK_DISABLED=true

# Start all containers in detached mode
podman compose -f infra/docker-compose.yml up -d

# Check container status
podman ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"

# Follow logs for a specific service
podman logs -f grafana_demo</code></pre>
    </div>
  </div>

  <h3>Verify each service is healthy</h3>
  <pre><code># Prometheus
curl http://localhost:9090/-/ready
# â†’ Prometheus Server is Ready.

# Grafana
curl http://localhost:3000/api/health
# â†’ {"database":"ok","version":"11.4.0",...}

# Tempo (takes ~20 s to initialise the ingester ring)
curl http://localhost:3200/ready
# â†’ Ingester is ready

# OTel Collector debug page
open http://localhost:55679/debug/tracez  # macOS
xdg-open http://localhost:55679/debug/tracez  # Linux</code></pre>

  <div class="callout warn">
    <div class="label">Tempo startup delay</div>
    Tempo's ingester ring takes 15â€“20 seconds to initialise after the container starts.
    The app can begin sending spans immediately â€” Tempo buffers them in its WAL.
  </div>

  <h3>Container management commands</h3>

  <div class="tab-group" id="tg-containers">
    <div class="tab-header">
      <button class="tab-btn active-docker" data-rt="docker" onclick="switchTab('tg-containers','docker')">ğŸ‹ Docker</button>
      <button class="tab-btn" data-rt="podman" onclick="switchTab('tg-containers','podman')">ğŸ¦­ Podman</button>
    </div>
    <div class="tab-content active" data-rt="docker">
<pre><code># List running containers
docker ps

# View logs (all services)
docker compose -f infra/docker-compose.yml logs --tail=50

# View logs for one service
docker logs grafana_demo -f

# Restart a single service (e.g. after config change)
docker compose -f infra/docker-compose.yml restart tempo

# Stop and keep volumes
docker compose -f infra/docker-compose.yml down

# Stop and destroy all volumes (fresh start)
docker compose -f infra/docker-compose.yml down -v</code></pre>
    </div>
    <div class="tab-content" data-rt="podman">
<pre><code># List running containers
podman ps

# View logs (all services via compose)
podman compose -f infra/docker-compose.yml logs --tail=50

# View logs for one container
podman logs grafana_demo -f

# Restart a single service
podman compose -f infra/docker-compose.yml restart tempo

# Stop and keep volumes
podman compose -f infra/docker-compose.yml down

# Stop and destroy all volumes (fresh start)
podman compose -f infra/docker-compose.yml down -v</code></pre>
    </div>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="start-app" class="anchor"><span class="h-icon">âš™ï¸</span> 2 â€” Start the Application</h2>

  <h3>Option A â€” Automated script</h3>
  <pre><code># Build + start (first time)
./infra/start-app.sh

# Skip rebuild if JAR already exists
SKIP_BUILD=true ./infra/start-app.sh</code></pre>

  <p>
    The script builds the JAR (Java 21, skipping tests), starts the app with the OTel agent,
    and waits for <code>/actuator/health</code> to return <code>UP</code> before printing URLs.
    Output is tailed to <code>app.log</code> in the project root.
  </p>

  <h3>Option B â€” Manual</h3>
  <pre><code># 1. Build (Java 21 mandatory)
JAVA_HOME=$(/usr/libexec/java_home -v 21) mvn clean package -DskipTests

# 2. Start with OTel agent (background, log to file)
$(/usr/libexec/java_home -v 21)/bin/java \
  -javaagent:opentelemetry-javaagent.jar \
  -Dspring.profiles.active=local \
  -Dotel.service.name=otel-demo \
  -Dotel.exporter.otlp.endpoint=http://localhost:4318 \
  -Dotel.exporter.otlp.protocol=http/protobuf \
  -Dotel.traces.sampler=always_on \
  -Dotel.metrics.exporter=otlp \
  -Dotel.logs.exporter=otlp \
  -jar target/otel-*-SNAPSHOT.jar \
  > app.log 2>&1 &

# 3. Watch startup
tail -f app.log | grep -E "Started|ERROR|trace_id"

# 4. Health check
curl http://localhost:8080/actuator/health</code></pre>

  <div class="callout danger">
    <div class="label">Critical â€” never disable default instrumentation</div>
    <p>
      Do <strong>not</strong> add <code>otel.instrumentation.common.default-enabled: false</code>
      to <code>application-local.yml</code>. Spring's OTel autoconfigure reads this on startup
      and disables <em>all</em> bytecode instrumentation â€” resulting in empty <code>trace_id=</code>
      in MDC and zero spans exported. The current config is correct and should not be modified.
    </p>
  </div>

  <div class="callout info">
    <div class="label">Running tests with Testcontainers</div>
    <p>Testcontainers needs the container runtime socket. Run the full suite with:</p>

    <div class="tab-group" id="tg-tests" style="margin-top:.6rem">
      <div class="tab-header">
        <button class="tab-btn active-docker" data-rt="docker" onclick="switchTab('tg-tests','docker')">ğŸ‹ Docker</button>
        <button class="tab-btn" data-rt="podman" onclick="switchTab('tg-tests','podman')">ğŸ¦­ Podman</button>
      </div>
      <div class="tab-content active" data-rt="docker">
<pre><code>JAVA_HOME=$(/usr/libexec/java_home -v 21) mvn test</code></pre>
      </div>
      <div class="tab-content" data-rt="podman">
<pre><code>export DOCKER_HOST="unix://$(podman machine inspect \
  --format '{{.ConnectionInfo.PodmanSocket.Path}}')"
export TESTCONTAINERS_RYUK_DISABLED=true
JAVA_HOME=$(/usr/libexec/java_home -v 21) mvn test</code></pre>
      </div>
    </div>
    <p style="margin-top:.4rem">Expected result: <strong>263 tests, 0 failures, 1 skipped</strong> (the <code>@Disabled</code> OTel trace test, deferred to Spring Boot 4 upgrade).</p>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="verify-signals" class="anchor"><span class="h-icon">ğŸ”</span> 3 â€” Verify All Three Signals</h2>

  <h3>First, generate a test request</h3>
  <pre><code>curl -s -X POST http://localhost:8080/api/v1/customers \
  -H "Content-Type: application/json" \
  -d '{
    "type":"INDIVIDUAL",
    "firstName":"Test","lastName":"Signal",
    "emails":[{"primary":true,"email":"signal@verify.com","type":"PERSONAL"}],
    "phones":[{"type":"MOBILE","countryCode":"+1","number":"5550001111"}],
    "addresses":[{"type":"HOME","line1":"1 Test St","city":"Chicago",
                  "state":"IL","postalCode":"60601","country":"USA"}]
  }' | python3 -m json.tool</code></pre>

  <h3>Check traces in Tempo</h3>
  <pre><code># Service names visible to Tempo
curl -s http://localhost:3200/api/search/tag/service.name/values | python3 -m json.tool
# â†’ {"tagValues":["otel-demo","tempo-all"]}

# Search recent traces
curl -s "http://localhost:3200/api/search?tags=service.name%3Dotel-demo&limit=5" \
  | python3 -m json.tool</code></pre>

  <h3>Check metrics in Prometheus</h3>
  <pre><code># Confirm the HTTP request counter exists
curl -s 'http://localhost:9090/api/v1/query?query=otel_http_server_request_duration_seconds_count' \
  | python3 -c "import sys,json; r=json.load(sys.stdin); \
    print(f'{len(r[\"data\"][\"result\"])} time series found')"

# Check the exported_job label value
curl -s 'http://localhost:9090/api/v1/query?query=otel_http_server_request_duration_seconds_count' \
  | python3 -c "import sys,json; r=json.load(sys.stdin); \
    m=r['data']['result']; print(m[0]['metric'] if m else 'no data')"</code></pre>

  <h3>Check logs in Loki</h3>
  <pre><code># List label names â€” should include service_name
curl -s http://localhost:3100/loki/api/v1/labels | python3 -m json.tool

# Query last 5 minutes of app logs
curl -sG http://localhost:3100/loki/api/v1/query_range \
  --data-urlencode 'query={service_name="otel-demo"}' \
  --data-urlencode 'limit=5' \
  | python3 -c "
import sys,json
d=json.load(sys.stdin)
streams=d.get('data',{}).get('result',[])
print(f'{len(streams)} log stream(s)')
for s in streams[:2]:
    vals=s.get('values',[])
    if vals: print(' ', vals[-1][1][:140])
"</code></pre>

  <div class="callout success">
    <div class="label">Expected outcome</div>
    <ul>
      <li><strong>Tempo</strong>: <code>otel-demo</code> appears in service list; traces visible</li>
      <li><strong>Prometheus</strong>: <code>otel_http_server_request_duration_seconds_count</code> has results with <code>exported_job="otel-demo"</code></li>
      <li><strong>Loki</strong>: log lines with non-empty <code>trace_id</code> and <code>span_id</code> fields</li>
    </ul>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="api-endpoints" class="anchor"><span class="h-icon">ğŸ“‹</span> API Endpoints Reference</h2>

  <p>Base path: <code>http://localhost:8080/api/v1/customers</code></p>

  <div class="table-wrap">
  <table>
    <thead>
      <tr><th>Method</th><th>Path</th><th>Description</th><th>Success</th><th>Errors</th></tr>
    </thead>
    <tbody>
      <tr><td><span class="badge post">POST</span></td><td><code>/customers</code></td><td>Create a new customer</td><td><span class="badge s201">201</span></td><td><span class="badge s400">400</span> <span class="badge s409">409</span></td></tr>
      <tr><td><span class="badge get">GET</span></td><td><code>/customers/{id}</code></td><td>Fetch by TSID</td><td><span class="badge s200">200</span></td><td><span class="badge s404">404</span></td></tr>
      <tr><td><span class="badge get">GET</span></td><td><code>/customers?limit=N&amp;after=cursor</code></td><td>Keyset-paginated list</td><td><span class="badge s200">200</span></td><td>â€”</td></tr>
      <tr><td><span class="badge patch">PATCH</span></td><td><code>/customers/{id}</code></td><td>Partial update (RFC 7396)</td><td><span class="badge s200">200</span></td><td><span class="badge s404">404</span></td></tr>
      <tr><td><span class="badge put">PUT</span></td><td><code>/customers/{id}</code></td><td>Full replace â€” all fields</td><td><span class="badge s200">200</span></td><td><span class="badge s400">400</span> <span class="badge s404">404</span></td></tr>
      <tr><td><span class="badge get">GET</span></td><td><code>/customers/search?email=</code></td><td>Find by email address</td><td><span class="badge s200">200</span></td><td><span class="badge s404">404</span></td></tr>
      <tr><td><span class="badge get">GET</span></td><td><code>/customers/search?ssn=</code></td><td>Find by SSN document</td><td><span class="badge s200">200</span></td><td><span class="badge s404">404</span></td></tr>
      <tr><td><span class="badge delete">DELETE</span></td><td><code>/customers/{id}</code></td><td>Delete â€” publishes CloudEvent</td><td><span class="badge s204">204</span></td><td><span class="badge s404">404</span></td></tr>
    </tbody>
  </table>
  </div>

  <h2 id="api-create" class="anchor"><span class="h-icon">â•</span> Create Customer</h2>
  <pre><code>POST /api/v1/customers
Content-Type: application/json

{
  "type": "INDIVIDUAL",
  "firstName": "Jane",
  "lastName": "Smith",
  "middleName": "Marie",        <span class="comment">// optional</span>
  "suffix": "Jr",               <span class="comment">// optional</span>
  "emails": [
    {"primary": true, "email": "jane.smith@example.com", "type": "PERSONAL"}
  ],
  "phones": [
    {"type": "MOBILE", "countryCode": "+1", "number": "5551234567"}
  ],
  "addresses": [
    {
      "type": "HOME",
      "line1": "123 Elm Street", "line2": "Apt 4B",  <span class="comment">// line2/line3 optional</span>
      "city": "Chicago", "state": "IL",
      "postalCode": "60601", "country": "USA"
    }
  ],
  "documents": [
    {"country": "USA", "type": "SSN", "identifier": "123-45-6789"}  <span class="comment">// optional</span>
  ]
}</code></pre>

  <p><strong>Response 201</strong> â€” full Customer object with generated <code>id</code> (TSID), <code>createdAt</code>, and <code>updatedAt</code>.</p>
  <p>
    <strong>Validation:</strong> <code>emails</code>, <code>phones</code>, and <code>addresses</code>
    must each have â‰¥ 1 entry (<code>@NotEmpty</code>). Duplicate email or SSN returns
    <span class="badge s409">409</span>.
  </p>

  <h2 id="api-get" class="anchor"><span class="h-icon">ğŸ”</span> Get Customer by ID</h2>
  <pre><code>GET /api/v1/customers/814948546554233853

# Response 200
{
  "id": 814948546554233853,
  "type": "INDIVIDUAL",
  "firstName": "Jane",
  "lastName": "Smith",
  ...
  "createdAt": "2026-02-26T19:54:34.510778Z",
  "updatedAt": "2026-02-26T19:54:34.510778Z"
}</code></pre>

  <h2 id="api-list" class="anchor"><span class="h-icon">ğŸ“„</span> List Customers (Keyset Pagination)</h2>
  <pre><code># First page â€” oldest records first (by TSID ascending)
GET /api/v1/customers?limit=10

# Response 200
{
  "data": [...],
  "nextCursor": 814948546554233853,
  "hasMore": true,
  "limit": 10
}

# Next page â€” pass last ID from previous response as cursor
GET /api/v1/customers?limit=10&amp;after=814948546554233853</code></pre>

  <p>
    When <code>hasMore</code> is <code>false</code> you have reached the last page.
    There is no <code>offset</code> or <code>page</code> parameter â€” keyset pagination
    is O(1) regardless of dataset size.
  </p>

  <h2 id="api-patch" class="anchor"><span class="h-icon">âœï¸</span> Partial Update (PATCH)</h2>
  <pre><code>PATCH /api/v1/customers/814948546554233853
Content-Type: application/merge-patch+json  <span class="comment">â† required; not application/json</span>

{"firstName": "Janet"}

# Response 200 â€” full customer; only firstName changed</code></pre>

  <div class="callout info">
    <div class="label">RFC 7396 JSON Merge Patch</div>
    Only the fields present in the request body are updated.
    To clear an optional field send it explicitly as <code>null</code>.
    Required fields (<code>emails</code>, <code>phones</code>, <code>addresses</code>)
    cannot be patched to empty â€” that fails bean validation on the next read.
  </div>

  <h2 id="api-put" class="anchor"><span class="h-icon">ğŸ”„</span> Full Replace (PUT)</h2>
  <pre><code>PUT /api/v1/customers/814948546554233853
Content-Type: application/json

{
  "id": 814948546554233853,      <span class="comment">// must match path param</span>
  "type": "INDIVIDUAL",
  "firstName": "Janet",
  "lastName": "Smith",
  "emails":    [{"primary": true, "email": "janet@example.com", "type": "PERSONAL"}],
  "phones":    [{"type": "MOBILE", "countryCode": "+1", "number": "5557654321"}],
  "addresses": [{"type": "HOME", "line1": "456 Oak Ave", "city": "Austin",
                 "state": "TX", "postalCode": "78701", "country": "USA"}],
  "createdAt": "2026-02-26T19:54:34.510778Z"  <span class="comment">// preserve original</span>
}

# Response 200 â€” full replaced customer</code></pre>

  <h2 id="api-search" class="anchor"><span class="h-icon">ğŸ”</span> Search</h2>
  <pre><code># By email
GET /api/v1/customers/search?email=jane.smith@example.com

# By SSN
GET /api/v1/customers/search?ssn=123-45-6789

# Both return: 200 with single Customer object, or 404 Problem Details</code></pre>

  <h2 id="api-delete" class="anchor"><span class="h-icon">ğŸ—‘</span> Delete Customer</h2>
  <pre><code>DELETE /api/v1/customers/814948546554233853

# 204 No Content â€” Customer::deleted CloudEvent published to Kafka</code></pre>

  <h2 id="api-errors" class="anchor"><span class="h-icon">âš ï¸</span> Error Responses (RFC 7807)</h2>
  <pre><code>{
  "type":     "https://api.example.com/errors/404",
  "title":    "Customer Not Found",
  "status":   404,
  "detail":   "Customer with id 9999999999 not found",
  "instance": "/api/v1/customers/9999999999",
  "traceId":  "4bf92f3577b34da6a3ce929d0e0e4736",   <span class="comment">// OTel trace ID</span>
  "spanId":   "00f067aa0ba902b7"
}</code></pre>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Status</th><th>Condition</th></tr></thead>
    <tbody>
      <tr><td><span class="badge s400">400</span></td><td>Bean validation failure â€” missing required fields</td></tr>
      <tr><td><span class="badge s404">404</span></td><td>Customer not found by ID, email, or SSN</td></tr>
      <tr><td><span class="badge s409">409</span></td><td>Duplicate email or SSN on create</td></tr>
      <tr><td>415</td><td>Wrong Content-Type â€” PATCH requires <code>application/merge-patch+json</code></td></tr>
      <tr><td>500</td><td>Internal error (DB unavailable, serialization error)</td></tr>
    </tbody>
  </table>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="load-test" class="anchor"><span class="h-icon">âš¡</span> Load Test Script</h2>

  <p>
    <code>infra/load-test.sh</code> generates sustained traffic across every endpoint,
    including intentional 404s to populate the error-rate Grafana panel.
    All created records are deleted on completion.
  </p>

  <pre><code># Default: 5 rounds, 0.3s pause between requests
./infra/load-test.sh

# 20 rounds, 1 second pause â€” ~5 min of visible Grafana time-series
ROUNDS=20 PAUSE=1.0 ./infra/load-test.sh

# Point at a different host
BASE_URL=http://staging.example.com/api/v1/customers ROUNDS=10 ./infra/load-test.sh</code></pre>

  <p><strong>Each round hits:</strong> POST â†’ GET â†’ LIST â†’ PATCH â†’ search â†’ PUT â†’ cursor-paginate â†’ Ã—2 intentional 404 â†’ DELETE (cleanup)</p>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="e2e-test" class="anchor"><span class="h-icon">ğŸ§ª</span> End-to-End Customer Lifecycle Test</h2>

  <p>
    <code>infra/e2e-test.sh</code> runs a complete, ordered lifecycle with 40 assertions.
    Exits 0 on full pass, 1 on any failure.
  </p>

  <pre><code>./infra/e2e-test.sh</code></pre>

  <div class="steps">
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>POST</strong> â€” Create with email, phone, address, SSN document. Assert 201, non-empty <code>id</code>, and <code>createdAt</code>.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>GET /{id}</strong> â€” Fetch and verify all fields: firstName, lastName, middleName, email, phone, city.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>GET ?limit=20</strong> â€” Verify the paginated list returns the correct <code>data/hasMore/limit</code> envelope and cursor pagination works.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>PATCH /{id}</strong> â€” Partial update of <code>firstName</code>. Assert field changed, <code>lastName</code> unchanged, <code>updatedAt</code> advanced.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>GET /{id}</strong> â€” Re-fetch after PATCH. Confirms patch persisted to DB.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>PUT /{id}</strong> â€” Full replace with different name, city, phone. Assert replaced fields and optional fields cleared.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>GET /{id}</strong> â€” Re-fetch after PUT. Confirms full replacement persisted, <code>middleName</code> cleared.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>GET /search?email=</strong> â€” Confirm customer findable by email, returns correct record.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>DELETE /{id}</strong> â€” Assert 204 No Content.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>GET /{id}</strong> â€” Confirm 404 after delete; verify RFC 7807 Problem Details format.
    </div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">
      <strong>GET /search?email=</strong> â€” Confirm 404 on search post-delete (no stale index).
    </div></div>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="manual-curl" class="anchor"><span class="h-icon">ğŸ’»</span> Manual curl Examples</h2>

  <h3>Create and capture ID</h3>
  <pre><code>ID=$(curl -s -X POST http://localhost:8080/api/v1/customers \
  -H "Content-Type: application/json" \
  -d '{
    "type":"INDIVIDUAL","firstName":"Manual","lastName":"Test",
    "emails":[{"primary":true,"email":"manual@test.com","type":"PERSONAL"}],
    "phones":[{"type":"MOBILE","countryCode":"+1","number":"5550009999"}],
    "addresses":[{"type":"HOME","line1":"1 St","city":"Chicago",
                  "state":"IL","postalCode":"60601","country":"USA"}]
  }' | python3 -c "import sys,json; print(json.load(sys.stdin)['id'])")
echo "Created: $ID"</code></pre>

  <h3>PATCH a single field</h3>
  <pre><code>curl -s -X PATCH "http://localhost:8080/api/v1/customers/$ID" \
  -H "Content-Type: application/merge-patch+json" \
  -d '{"firstName":"Updated"}' | python3 -m json.tool</code></pre>

  <h3>Search by email</h3>
  <pre><code>curl -s "http://localhost:8080/api/v1/customers/search?email=manual@test.com" \
  | python3 -m json.tool</code></pre>

  <h3>Paginate through all customers</h3>
  <pre><code># Page 1
curl -s "http://localhost:8080/api/v1/customers?limit=5" | python3 -m json.tool

# Page 2 (use nextCursor from previous response)
curl -s "http://localhost:8080/api/v1/customers?limit=5&amp;after=$ID" | python3 -m json.tool</code></pre>

  <h3>Trigger a 400 validation error</h3>
  <pre><code>curl -s -X POST http://localhost:8080/api/v1/customers \
  -H "Content-Type: application/json" \
  -d '{"type":"INDIVIDUAL","firstName":"No","lastName":"Contacts"}' \
  | python3 -m json.tool
# â†’ 400 with RFC 7807 detail listing missing emails/phones/addresses</code></pre>

  <h3>Delete</h3>
  <pre><code>curl -s -X DELETE "http://localhost:8080/api/v1/customers/$ID" -w "HTTP %{http_code}\n"
# â†’ HTTP 204</code></pre>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="grafana-dashboards" class="anchor"><span class="h-icon">ğŸ“Š</span> Grafana Dashboards</h2>

  <p>
    Open <a href="http://localhost:3000" target="_blank">http://localhost:3000</a> â€” no login required
    (anonymous admin mode). Navigate: left sidebar â†’ Dashboards (grid icon).
  </p>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Dashboard</th><th>URL</th><th>Content</th></tr></thead>
    <tbody>
      <tr>
        <td><strong>otel-demo â€” App Overview</strong></td>
        <td><a href="http://localhost:3000/d/app-overview" target="_blank"><code>/d/app-overview</code></a></td>
        <td>Golden signals, JVM, DB pool, Kafka</td>
      </tr>
      <tr>
        <td><strong>otel-demo â€” HTTP Endpoints</strong></td>
        <td><a href="http://localhost:3000/d/http-endpoints" target="_blank"><code>/d/http-endpoints</code></a></td>
        <td>Per-endpoint drill-down with multi-select filter</td>
      </tr>
    </tbody>
  </table>
  </div>

  <h3>App Overview panels</h3>
  <ul>
    <li><strong>Request Rate</strong> â€” req/s stat with sparkline; blue always-on colour</li>
    <li><strong>Error Rate %</strong> â€” 4xx+5xx as percentage; green â†’ yellow at 1% â†’ red at 5%</li>
    <li><strong>p50 Latency</strong> â€” median response in ms; yellow at 200ms, red at 1000ms</li>
    <li><strong>p99 Latency</strong> â€” 99th percentile in ms; yellow at 500ms, red at 2000ms</li>
    <li><strong>Request Rate by Endpoint</strong> â€” time-series per <code>METHOD route</code> pair</li>
    <li><strong>Response Status Codes</strong> â€” 2xx (green), 4xx (yellow), 5xx (red) over time</li>
    <li><strong>Latency Percentiles</strong> â€” p50 / p95 / p99 across all endpoints</li>
    <li><strong>JVM Heap Memory</strong> â€” used vs committed vs max bytes</li>
    <li><strong>JVM CPU Utilization</strong> â€” process CPU ratio 0â€“1</li>
    <li><strong>DB Connection Pool</strong> â€” HikariCP idle / used / max</li>
    <li><strong>Kafka Producer Throughput</strong> â€” bytes/s per topic</li>
  </ul>

  <h3>HTTP Endpoints panels</h3>
  <ul>
    <li><strong>Endpoint selector</strong> â€” multi-select dropdown from Prometheus label values; choose specific routes or "All"</li>
    <li><strong>Stats row</strong> â€” rate, error %, p50, p99 for selected endpoint(s) only</li>
    <li><strong>Request Rate time-series</strong> â€” traffic per method+route over time</li>
    <li><strong>Status Code breakdown</strong> â€” 2xx/4xx/5xx for selected endpoints</li>
    <li><strong>Latency Percentiles by Endpoint</strong> â€” p50/p95/p99 per route</li>
    <li><strong>All Endpoints Summary table</strong> â€” sortable: Method, Route, req/s, errors/s, p50(ms), p99(ms) with colour backgrounds on p99 and errors</li>
  </ul>

  <div class="callout info">
    <div class="label">Time range</div>
    Dashboards default to <strong>Last 30 minutes</strong>. After the load test, switch to
    <strong>Last 5 minutes</strong> for the sharpest signal.
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="grafana-explore-traces" class="anchor"><span class="h-icon">ğŸ”­</span> Explore â€” Traces (Tempo)</h2>

  <div class="steps">
    <div class="step"><div class="step-num"></div><div class="step-body">Click the <strong>compass icon</strong> (Explore) in the left sidebar.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Select <strong>Tempo</strong> from the datasource dropdown.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Switch to <strong>Search</strong> tab. Set <em>Service Name</em> = <code>otel-demo</code>. Optionally filter by <em>Span Name</em> (e.g. <code>POST /api/v1/customers</code>).</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Click <strong>Run Query</strong>. A table of recent traces appears â€” each row is one HTTP request.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Click any trace row to open the <strong>waterfall / flame graph</strong>. You'll see the full span tree: HTTP server â†’ Spring Data â†’ JDBC â†’ Hibernate SQL â†’ Kafka producer.</div></div>
  </div>

  <h3>Typical POST /customers span tree</h3>
  <div class="diagram">
<span class="d-box">POST /api/v1/customers                               [0 ms â€¦ 45 ms]
  â””â”€ CustomerController.createCustomer                 [1 ms â€¦ 44 ms]
      â””â”€ CustomerService.create                        [2 ms â€¦ 43 ms]
          â”œâ”€ CustomerRepository.findByEmail (dup chk)  [2 ms â€¦ 5 ms]
          â”‚    â””â”€ SELECT * FROM customers (JDBC)       [2 ms â€¦ 4 ms]
          â”œâ”€ CustomerRepository.save                   [8 ms â€¦ 30 ms]
          â”‚    â””â”€ INSERT INTO customers (JDBC)         [9 ms â€¦ 28 ms]
          â””â”€ CustomerEventPublisher (Kafka producer)   [35 ms â€¦ 42 ms]</span>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="grafana-explore-logs" class="anchor"><span class="h-icon">ğŸ“œ</span> Explore â€” Logs (Loki)</h2>

  <div class="steps">
    <div class="step"><div class="step-num"></div><div class="step-body">In Explore, select <strong>Loki</strong> from the datasource dropdown.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Use <strong>Builder</strong> mode. Add label: <code>service_name = otel-demo</code>.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Click <strong>Run Query</strong>. Structured log lines appear with parsed <code>trace_id</code> and <code>span_id</code> fields.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Filter errors: append <code>| logfmt | level="ERROR"</code> to the query.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Click the <strong>Tempo link icon</strong> on any log line with a non-empty <code>trace_id</code> to jump to that trace.</div></div>
  </div>

  <h3>Useful LogQL queries</h3>
  <pre><code># All otel-demo logs
{service_name="otel-demo"}

# Only ERROR level
{service_name="otel-demo"} | logfmt | level="ERROR"

# Logs for a specific trace
{service_name="otel-demo"} | logfmt | trace_id="4bf92f3577b34da6a3ce929d0e0e4736"

# Hibernate SQL statements
{service_name="otel-demo"} |= "Hibernate:"</code></pre>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="grafana-explore-metrics" class="anchor"><span class="h-icon">ğŸ“ˆ</span> Explore â€” Metrics (Prometheus)</h2>

  <div class="steps">
    <div class="step"><div class="step-num"></div><div class="step-body">In Explore, select <strong>Prometheus</strong>.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Type a metric name in the query bar â€” autocomplete is active.</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Click <strong>Run Query</strong>. Switch between Graph and Table views.</div></div>
  </div>

  <h3>Key PromQL queries</h3>
  <pre><code># Request rate per endpoint
sum(rate(otel_http_server_request_duration_seconds_count{
    exported_job="otel-demo"}[5m])) by (http_request_method, http_route)

# Error rate %
100 * sum(rate(otel_http_server_request_duration_seconds_count{
    exported_job="otel-demo", http_response_status_code=~"[45].."}[5m]))
  / sum(rate(otel_http_server_request_duration_seconds_count{
    exported_job="otel-demo"}[5m]))

# p99 latency in ms
histogram_quantile(0.99,
  sum(rate(otel_http_server_request_duration_seconds_bucket{
      exported_job="otel-demo"}[5m])) by (le, http_route)) * 1000

# JVM heap used
sum(otel_jvm_memory_used_bytes{exported_job="otel-demo", jvm_memory_type="heap"})

# DB connection pool
otel_db_client_connections_usage{exported_job="otel-demo", state="used"}</code></pre>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="trace-log-correlation" class="anchor"><span class="h-icon">ğŸ”—</span> Trace â†’ Log Correlation</h2>

  <p>
    Every log line emitted during a request contains the active <code>trace_id</code> and
    <code>span_id</code> via Logback MDC. Grafana Tempo links directly to matching Loki lines.
  </p>

  <div class="steps">
    <div class="step"><div class="step-num"></div><div class="step-body">Open a trace in Tempo (Explore â†’ Tempo â†’ Search â†’ click a trace).</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">In the span detail panel, click the <strong>Logs for this span</strong> button (Loki icon).</div></div>
    <div class="step"><div class="step-num"></div><div class="step-body">Grafana opens Explore â†’ Loki pre-filtered to <code>{service_name="otel-demo"} | trace_id="â€¦"</code>.</div></div>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="ts-no-traces" class="anchor"><span class="h-icon">ğŸ©º</span> Troubleshooting â€” No Traces</h2>

  <p><strong>Symptom:</strong> Tempo search returns no results; logs show <code>trace_id= span_id=</code> (empty).</p>

  <pre><code># 1. Is the OTel agent attached?
ps aux | grep javaagent
# â†’ must include: -javaagent:opentelemetry-javaagent.jar

# 2. Debug mode â€” logs every exported span
$JAVA_BIN -javaagent:opentelemetry-javaagent.jar \
  -Dotel.javaagent.debug=true ...

# 3. Collector receiving spans?
curl http://localhost:55679/debug/tracez   # check Running/Completed spans</code></pre>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Cause</th><th>Fix</th></tr></thead>
    <tbody>
      <tr><td><code>otel.instrumentation.common.default-enabled: false</code> in YAML</td><td>Remove that property entirely</td></tr>
      <tr><td>App started without <code>-javaagent:</code> flag</td><td>Use <code>./infra/start-app.sh</code> or add flag manually</td></tr>
      <tr><td>Wrong Java binary (Java 25 on PATH)</td><td>Use <code>$(/usr/libexec/java_home -v 21)/bin/java</code></td></tr>
      <tr><td>OTel Collector not running</td><td>Check <code>docker ps</code> / <code>podman ps</code>; confirm port 4318 is listening</td></tr>
      <tr><td>Tempo WAL not flushed</td><td>Wait 30s after first request (<code>max_block_duration=30s</code>)</td></tr>
    </tbody>
  </table>
  </div>

  <h2 id="ts-no-metrics" class="anchor"><span class="h-icon">ğŸ©º</span> Troubleshooting â€” No Metrics</h2>
  <pre><code># 1. Collector exposing metrics?
curl http://localhost:8889/metrics | grep otel_http

# 2. Prometheus scraping Collector?
curl 'http://localhost:9090/api/v1/targets' | python3 -m json.tool | grep -A5 otel

# 3. Metric exists?
curl 'http://localhost:9090/api/v1/query?query=otel_http_server_request_duration_seconds_count'</code></pre>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Cause</th><th>Fix</th></tr></thead>
    <tbody>
      <tr><td>No requests made yet</td><td>Make at least one API call; wait 30s for Prometheus scrape</td></tr>
      <tr><td>Wrong metric name</td><td>Use <code>otel_</code> prefix, not <code>http_server_requests_seconds</code> (Micrometer)</td></tr>
      <tr><td>Wrong label: <code>job</code> vs <code>exported_job</code></td><td>Filter with <code>exported_job="otel-demo"</code></td></tr>
    </tbody>
  </table>
  </div>

  <h2 id="ts-no-logs" class="anchor"><span class="h-icon">ğŸ©º</span> Troubleshooting â€” No Logs in Loki</h2>
  <pre><code># Labels present?
curl -s http://localhost:3100/loki/api/v1/labels | python3 -m json.tool
# â†’ should include "service_name"

# Query directly
curl -sG http://localhost:3100/loki/api/v1/query \
  --data-urlencode 'query={service_name="otel-demo"}' \
  --data-urlencode 'limit=5'</code></pre>

  <h2 id="ts-dashboards-empty" class="anchor"><span class="h-icon">ğŸ©º</span> Troubleshooting â€” Empty Grafana Dashboards</h2>
  <ol>
    <li>Make at least a few API requests, then wait 30â€“60 seconds.</li>
    <li>Confirm metrics exist: <code>curl 'http://localhost:9090/api/v1/query?query=otel_http_server_request_duration_seconds_count'</code></li>
    <li>Set dashboard time range to <strong>Last 5 minutes</strong> or <strong>Last 30 minutes</strong>.</li>
    <li>Check the Prometheus datasource UID in Grafana is <code>prometheus</code> (Connections â†’ Data Sources).</li>
  </ol>

  <h3>Dashboard provisioning errors</h3>

  <div class="tab-group" id="tg-provision">
    <div class="tab-header">
      <button class="tab-btn active-docker" data-rt="docker" onclick="switchTab('tg-provision','docker')">ğŸ‹ Docker</button>
      <button class="tab-btn" data-rt="podman" onclick="switchTab('tg-provision','podman')">ğŸ¦­ Podman</button>
    </div>
    <div class="tab-content active" data-rt="docker">
<pre><code>docker logs grafana_demo 2>&1 | grep -i "provision\|error"

# Typical fix â€” restart with fresh volumes
docker compose -f infra/docker-compose.yml down -v
docker compose -f infra/docker-compose.yml up -d</code></pre>
    </div>
    <div class="tab-content" data-rt="podman">
<pre><code>podman logs grafana_demo 2>&1 | grep -i "provision\|error"

# Typical fix â€” restart with fresh volumes
podman compose -f infra/docker-compose.yml down -v
podman compose -f infra/docker-compose.yml up -d</code></pre>
    </div>
  </div>

  <h2 id="ts-tempo" class="anchor"><span class="h-icon">ğŸ©º</span> Troubleshooting â€” Tempo Issues</h2>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Symptom</th><th>Cause</th><th>Fix</th></tr></thead>
    <tbody>
      <tr>
        <td><code>empty ring</code> error</td>
        <td>Tempo <code>latest</code> is v3.x â€” partition ring incompatible with single-node</td>
        <td>Pinned to <code>grafana/tempo:2.7.1</code> in docker-compose.yml âœ“ already done</td>
      </tr>
      <tr>
        <td><code>field compactor not found</code></td>
        <td>Tempo v3.x removed <code>compactor</code> block</td>
        <td>Removed from tempo.yaml âœ“ already done</td>
      </tr>
      <tr>
        <td>Spans in Collector, not in Tempo</td>
        <td>WAL not flushed yet</td>
        <td>Wait 30s â€” <code>max_block_duration=30s</code></td>
      </tr>
      <tr>
        <td><code>/ready</code> non-200 for 20+ seconds</td>
        <td>Ingester ring init is slow</td>
        <td>Normal â€” wait; app can send spans immediately</td>
      </tr>
    </tbody>
  </table>
  </div>

  <hr />

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="otel-config" class="anchor"><span class="h-icon">âš™ï¸</span> OTel Configuration Reference</h2>

  <h3>System properties (passed to JVM at startup)</h3>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Property</th><th>Value</th><th>Purpose</th></tr></thead>
    <tbody>
      <tr><td><code>otel.service.name</code></td><td><code>otel-demo</code></td><td>Service name in Tempo, Loki, Prometheus</td></tr>
      <tr><td><code>otel.exporter.otlp.endpoint</code></td><td><code>http://localhost:4318</code></td><td>OTel Collector HTTP endpoint</td></tr>
      <tr><td><code>otel.exporter.otlp.protocol</code></td><td><code>http/protobuf</code></td><td>HTTP transport (vs gRPC <code>:4317</code>)</td></tr>
      <tr><td><code>otel.traces.sampler</code></td><td><code>always_on</code></td><td>Sample every request (demo setting)</td></tr>
      <tr><td><code>otel.metrics.exporter</code></td><td><code>otlp</code></td><td>Push metrics via OTLP to Collector</td></tr>
      <tr><td><code>otel.logs.exporter</code></td><td><code>otlp</code></td><td>Push logs via OTLP to Collector</td></tr>
    </tbody>
  </table>
  </div>

  <h3>application-local.yml (Spring profile)</h3>
  <pre><code>otel:
  service:
    name: otel-demo
  metrics:
    exporter: otlp
  traces:
    sampler: always_on
    exporter: otlp
  logs:
    exporter: otlp
  exporter:
    otlp:
      endpoint: http://localhost:4318
      protocol: http/protobuf
  instrumentation:
    kafka:
      experimental-span-attributes: true
      autoconfigure-interceptor: true

<span class="comment"># âš ï¸  Never add: otel.instrumentation.common.default-enabled: false
#    This disables ALL auto-instrumentation and produces empty trace IDs</span></code></pre>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="metric-names" class="anchor"><span class="h-icon">ğŸ“</span> Prometheus Metric Names</h2>

  <div class="callout warn">
    <div class="label">OTel agent naming differs from Micrometer</div>
    <p>
      The OTel Java agent uses OpenTelemetry semantic convention names
      (prefixed <code>otel_</code> after Prometheus relabeling).
      These are <strong>different</strong> from Micrometer/Spring Actuator names
      such as <code>http_server_requests_seconds_count</code>.
      Always use the <code>otel_*</code> names below.
    </p>
  </div>

  <div class="table-wrap">
  <table>
    <thead><tr><th>Metric</th><th>Type</th><th>Key Labels</th><th>Description</th></tr></thead>
    <tbody>
      <tr>
        <td><code>otel_http_server_request_duration_seconds_count</code></td>
        <td>counter</td>
        <td><code>exported_job, http_route, http_request_method, http_response_status_code</code></td>
        <td>Total HTTP requests</td>
      </tr>
      <tr>
        <td><code>otel_http_server_request_duration_seconds_sum</code></td>
        <td>counter</td>
        <td>same</td>
        <td>Cumulative duration in seconds</td>
      </tr>
      <tr>
        <td><code>otel_http_server_request_duration_seconds_bucket</code></td>
        <td>histogram</td>
        <td>same + <code>le</code></td>
        <td>Duration histogram (used for quantile queries)</td>
      </tr>
      <tr>
        <td><code>otel_jvm_memory_used_bytes</code></td>
        <td>gauge</td>
        <td><code>exported_job, jvm_memory_type, jvm_memory_pool_name</code></td>
        <td>JVM memory used</td>
      </tr>
      <tr>
        <td><code>otel_jvm_memory_committed_bytes</code></td>
        <td>gauge</td>
        <td>same</td>
        <td>JVM memory committed to OS</td>
      </tr>
      <tr>
        <td><code>otel_jvm_memory_limit_bytes</code></td>
        <td>gauge</td>
        <td>same</td>
        <td>JVM -Xmx limit</td>
      </tr>
      <tr>
        <td><code>otel_jvm_cpu_recent_utilization_ratio</code></td>
        <td>gauge</td>
        <td><code>exported_job</code></td>
        <td>Process CPU utilization 0â€“1</td>
      </tr>
      <tr>
        <td><code>otel_db_client_connections_usage</code></td>
        <td>gauge</td>
        <td><code>exported_job, state (idle|used)</code></td>
        <td>HikariCP connection pool</td>
      </tr>
      <tr>
        <td><code>otel_db_client_connections_max</code></td>
        <td>gauge</td>
        <td><code>exported_job</code></td>
        <td>HikariCP max pool size</td>
      </tr>
      <tr>
        <td><code>otel_kafka_producer_byte_rate</code></td>
        <td>gauge</td>
        <td><code>exported_job, topic</code></td>
        <td>Kafka producer throughput bytes/s</td>
      </tr>
    </tbody>
  </table>
  </div>

  <div class="callout info">
    <div class="label">Why exported_job, not job?</div>
    Prometheus scrapes metrics from the <em>OTel Collector</em>, not the app directly.
    The Collector's scrape job is named <code>otel-collector</code>. The original
    <code>job="otel-demo"</code> label from the app is automatically renamed to
    <code>exported_job="otel-demo"</code> to avoid collision with Prometheus's own
    <code>job</code> label. Always filter using <code>exported_job="otel-demo"</code>.
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <h2 id="key-files" class="anchor"><span class="h-icon">ğŸ“</span> Key Files</h2>

  <div class="table-wrap">
  <table>
    <thead><tr><th>File</th><th>Purpose</th></tr></thead>
    <tbody>
      <tr><td><code>infra/start.sh</code></td><td>Start full stack â€” auto-detects Docker/Podman</td></tr>
      <tr><td><code>infra/stop.sh</code></td><td>Stop stack; <code>--destroy</code> wipes volumes</td></tr>
      <tr><td><code>infra/start-app.sh</code></td><td>Build &amp; start Spring Boot with OTel agent</td></tr>
      <tr><td><code>infra/load-test.sh</code></td><td>Sustained load across all endpoints</td></tr>
      <tr><td><code>infra/e2e-test.sh</code></td><td>Full lifecycle test â€” 40 assertions, exits 0/1</td></tr>
      <tr><td><code>infra/docker-compose.yml</code></td><td>Container stack definition (7 services)</td></tr>
      <tr><td><code>infra/otel-collector.yml</code></td><td>OTel Collector pipeline</td></tr>
      <tr><td><code>infra/tempo.yaml</code></td><td>Tempo single-node config (pinned 2.7.1)</td></tr>
      <tr><td><code>infra/prometheus.yml</code></td><td>Prometheus scrape config (Collector :8889)</td></tr>
      <tr><td><code>infra/datasources.yaml</code></td><td>Grafana datasources with traceâ†”log links</td></tr>
      <tr><td><code>infra/grafana/dashboards/app-overview.json</code></td><td>Golden signals dashboard</td></tr>
      <tr><td><code>infra/grafana/dashboards/http-endpoints.json</code></td><td>Per-endpoint drill-down dashboard</td></tr>
      <tr><td><code>src/main/resources/application-local.yml</code></td><td>Local profile â€” OTel, DB, Kafka config</td></tr>
      <tr><td><code>opentelemetry-javaagent.jar</code></td><td>OTel Java agent (project root â€” not in Git)</td></tr>
    </tbody>
  </table>
  </div>

  <hr />
  <p class="muted" style="text-align:center; margin: 2rem 0; font-size:.8rem;">
    otel-demo &nbsp;Â·&nbsp; Spring Boot 3.5 &nbsp;Â·&nbsp; OTel Java Agent 2.x &nbsp;Â·&nbsp;
    Grafana 11.4 &nbsp;Â·&nbsp; Tempo 2.7.1 &nbsp;Â·&nbsp; Prometheus &nbsp;Â·&nbsp; Loki
  </p>

</main>
</div>
</body>
</html>
